<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar Cofre Digital - Conte√∫do | LegadoBox</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .step-active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .step-completed { background: #10b981; color: white; }
        .step-inactive { background: #e5e7eb; color: #6b7280; }
        .upload-area { border: 2px dashed #d1d5db; transition: all 0.3s ease; }
        .upload-area.dragover { border-color: #667eea; background-color: #667eea10; }
        .upload-area:hover { border-color: #667eea50; }
        .photo-preview { position: relative; overflow: hidden; }
        .photo-preview img { transition: transform 0.3s ease; }
        .photo-preview:hover img { transform: scale(1.05); }
        .album-tab { cursor: pointer; transition: all 0.3s ease; }
        .album-tab.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .message-editor { min-height: 200px; }
        .ai-suggestion { background: linear-gradient(135deg, #f3e8ff 0%, #e0e7ff 100%); }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-4 px-4">
        <div class="max-w-6xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                    <i data-lucide="heart" class="w-6 h-6"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold">LegadoBox</h1>
                    <p class="text-white/80 text-sm">Criar Conte√∫do do Cofre</p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-right">
                    <p class="text-sm text-white/80">Destinat√°rio:</p>
                    <p class="font-semibold" id="recipientName">Maria Silva</p>
                </div>
                <button onclick="goBack()" class="flex items-center space-x-2 text-white/80 hover:text-white">
                    <i data-lucide="arrow-left" class="w-5 h-5"></i>
                    <span>Voltar</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Progress Steps -->
    <section class="py-6 px-4 bg-white border-b">
        <div class="max-w-4xl mx-auto flex items-center justify-center space-x-8">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 rounded-full step-completed flex items-center justify-center font-semibold">
                    <i data-lucide="check" class="w-5 h-5"></i>
                </div>
                <span class="font-medium text-gray-900">Configura√ß√£o</span>
            </div>
            <div class="w-16 h-1 bg-green-500 rounded"></div>
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 rounded-full step-active flex items-center justify-center font-semibold">2</div>
                <span class="font-medium text-gray-900">Conte√∫do</span>
            </div>
            <div class="w-16 h-1 bg-gray-200 rounded"></div>
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 rounded-full step-inactive flex items-center justify-center font-semibold">3</div>
                <span class="font-medium text-gray-500">Finalizar</span>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="py-8 px-4">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">üìù Criar Conte√∫do do Cofre</h2>
                <p class="text-xl text-gray-600">Adicione fotos, v√≠deos e mensagens especiais para <span id="recipientNameContent">Maria</span></p>
            </div>

            <!-- Content Tabs -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                <div class="border-b">
                    <nav class="flex">
                        <button onclick="switchTab('photos')" class="tab-button flex-1 py-4 px-6 text-center font-medium border-b-2 border-transparent hover:text-blue-600 hover:border-blue-300 transition-colors" id="photosTab">
                            <div class="flex items-center justify-center space-x-2">
                                <i data-lucide="image" class="w-5 h-5"></i>
                                <span>Fotos</span>
                                <span class="bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-xs" id="photosCount">0/40</span>
                            </div>
                        </button>
                        <button onclick="switchTab('videos')" class="tab-button flex-1 py-4 px-6 text-center font-medium border-b-2 border-transparent hover:text-blue-600 hover:border-blue-300 transition-colors" id="videosTab">
                            <div class="flex items-center justify-center space-x-2">
                                <i data-lucide="video" class="w-5 h-5"></i>
                                <span>V√≠deos</span>
                                <span class="bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-xs" id="videosCount">0/2</span>
                            </div>
                        </button>
                        <button onclick="switchTab('messages')" class="tab-button flex-1 py-4 px-6 text-center font-medium border-b-2 border-transparent hover:text-blue-600 hover:border-blue-300 transition-colors" id="messagesTab">
                            <div class="flex items-center justify-center space-x-2">
                                <i data-lucide="message-circle" class="w-5 h-5"></i>
                                <span>Mensagens</span>
                                <span class="bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-xs" id="messagesCount">0/5</span>
                            </div>
                        </button>
                    </nav>
                </div>

                <!-- Photos Tab -->
                <div id="photosContent" class="tab-content p-8">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold text-gray-900 mb-2">üì∏ √Ålbuns de Fotos</h3>
                        <p class="text-gray-600">Organize suas fotos em at√© 4 √°lbuns, com 10 fotos cada</p>
                    </div>

                    <!-- Album Tabs -->
                    <div class="flex space-x-2 mb-6">
                        <button onclick="switchAlbum(1)" class="album-tab px-4 py-2 rounded-lg bg-gray-100 text-gray-700 font-medium" id="album1Tab">
                            √Ålbum 1 <span class="text-xs">(0/10)</span>
                        </button>
                        <button onclick="switchAlbum(2)" class="album-tab px-4 py-2 rounded-lg bg-gray-100 text-gray-700 font-medium" id="album2Tab">
                            √Ålbum 2 <span class="text-xs">(0/10)</span>
                        </button>
                        <button onclick="switchAlbum(3)" class="album-tab px-4 py-2 rounded-lg bg-gray-100 text-gray-700 font-medium" id="album3Tab">
                            √Ålbum 3 <span class="text-xs">(0/10)</span>
                        </button>
                        <button onclick="switchAlbum(4)" class="album-tab px-4 py-2 rounded-lg bg-gray-100 text-gray-700 font-medium" id="album4Tab">
                            √Ålbum 4 <span class="text-xs">(0/10)</span>
                        </button>
                    </div>

                    <!-- Album Content -->
                    <div id="albumContent">
                        <div class="mb-4">
                            <input type="text" id="albumTitle" placeholder="Nome do √°lbum (ex: Mem√≥rias da Inf√¢ncia)" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>

                        <!-- Upload Area -->
                        <div class="upload-area bg-gray-50 rounded-xl p-8 text-center mb-6" ondrop="handlePhotoDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                            <i data-lucide="upload-cloud" class="w-12 h-12 text-gray-400 mx-auto mb-4"></i>
                            <h4 class="text-lg font-medium text-gray-900 mb-2">Arraste suas fotos aqui</h4>
                            <p class="text-gray-500 mb-4">ou clique para selecionar arquivos</p>
                            <input type="file" id="photoInput" multiple accept="image/*" class="hidden" onchange="handlePhotoSelect(event)">
                            <button onclick="document.getElementById('photoInput').click()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                Selecionar Fotos
                            </button>
                            <p class="text-xs text-gray-400 mt-2">M√°ximo 10 fotos por √°lbum ‚Ä¢ JPG, PNG ‚Ä¢ At√© 5MB cada</p>
                        </div>

                        <!-- Photos Grid -->
                        <div id="photosGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                            <!-- Photos will be added here dynamically -->
                        </div>
                    </div>
                </div>

                <!-- Videos Tab -->
                <div id="videosContent" class="tab-content p-8 hidden">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold text-gray-900 mb-2">üé• V√≠deos Especiais</h3>
                        <p class="text-gray-600">Adicione at√© 2 v√≠deos especiais para o destinat√°rio</p>
                    </div>

                    <!-- Upload Area -->
                    <div class="upload-area bg-gray-50 rounded-xl p-8 text-center mb-6" ondrop="handleVideoDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                        <i data-lucide="video" class="w-12 h-12 text-gray-400 mx-auto mb-4"></i>
                        <h4 class="text-lg font-medium text-gray-900 mb-2">Arraste seus v√≠deos aqui</h4>
                        <p class="text-gray-500 mb-4">ou clique para selecionar arquivos</p>
                        <input type="file" id="videoInput" multiple accept="video/*" class="hidden" onchange="handleVideoSelect(event)">
                        <button onclick="document.getElementById('videoInput').click()" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                            Selecionar V√≠deos
                        </button>
                        <p class="text-xs text-gray-400 mt-2">M√°ximo 2 v√≠deos ‚Ä¢ MP4, MOV ‚Ä¢ At√© 100MB cada</p>
                    </div>

                    <!-- Videos List -->
                    <div id="videosList" class="space-y-4">
                        <!-- Videos will be added here dynamically -->
                    </div>

                    <!-- AI Script Generator -->
                    <div class="ai-suggestion rounded-xl p-6 mt-8">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                <i data-lucide="sparkles" class="w-5 h-5 text-purple-600"></i>
                            </div>
                            <h4 class="text-lg font-bold text-gray-900">ü§ñ Assistente de Script com IA</h4>
                        </div>
                        <p class="text-gray-600 mb-4">Precisa de ajuda para criar um roteiro para seu v√≠deo? Nossa IA pode ajudar!</p>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Que tipo de v√≠deo voc√™ quer criar?</label>
                                <select id="videoType" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                    <option value="">Selecione o tipo...</option>
                                    <option value="birthday">Mensagem de anivers√°rio</option>
                                    <option value="advice">Conselhos para a vida</option>
                                    <option value="memories">Compartilhar mem√≥rias</option>
                                    <option value="love">Declara√ß√£o de amor</option>
                                    <option value="farewell">Mensagem de despedida</option>
                                    <option value="custom">Personalizado</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Detalhes adicionais (opcional)</label>
                                <textarea id="videoDetails" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Ex: Quero falar sobre nossa viagem para Paris em 2020, mencionar o restaurante onde comemos..."></textarea>
                            </div>
                            
                            <button onclick="generateScript()" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2">
                                <i data-lucide="sparkles" class="w-4 h-4"></i>
                                <span>Gerar Script com IA</span>
                            </button>
                        </div>
                        
                        <div id="generatedScript" class="hidden mt-6 p-4 bg-white rounded-lg border">
                            <h5 class="font-medium text-gray-900 mb-2">üìù Script Gerado:</h5>
                            <div id="scriptContent" class="text-gray-700 whitespace-pre-line"></div>
                            <div class="flex items-center space-x-2 mt-4">
                                <button onclick="copyScript()" class="text-sm bg-gray-100 text-gray-700 px-3 py-1 rounded hover:bg-gray-200 transition-colors">
                                    Copiar Script
                                </button>
                                <button onclick="regenerateScript()" class="text-sm bg-purple-100 text-purple-700 px-3 py-1 rounded hover:bg-purple-200 transition-colors">
                                    Gerar Novo
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Messages Tab -->
                <div id="messagesContent" class="tab-content p-8 hidden">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold text-gray-900 mb-2">üíå Mensagens Especiais</h3>
                        <p class="text-gray-600">Escreva at√© 5 mensagens especiais para o destinat√°rio</p>
                    </div>

                    <!-- Messages List -->
                    <div id="messagesList" class="space-y-6 mb-8">
                        <!-- Messages will be added here dynamically -->
                    </div>

                    <!-- Add Message Button -->
                    <button onclick="addMessage()" class="w-full border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-blue-400 hover:bg-blue-50 transition-colors">
                        <i data-lucide="plus-circle" class="w-8 h-8 text-gray-400 mx-auto mb-2"></i>
                        <p class="font-medium text-gray-600">Adicionar Nova Mensagem</p>
                        <p class="text-sm text-gray-400">Clique para criar uma mensagem especial</p>
                    </button>

                    <!-- AI Message Helper -->
                    <div class="ai-suggestion rounded-xl p-6 mt-8">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                <i data-lucide="sparkles" class="w-5 h-5 text-blue-600"></i>
                            </div>
                            <h4 class="text-lg font-bold text-gray-900">‚ú® Assistente de Mensagens com IA</h4>
                        </div>
                        <p class="text-gray-600 mb-4">Precisa de inspira√ß√£o? Nossa IA pode ajudar voc√™ a escrever mensagens emocionantes!</p>
                        
                        <div class="grid md:grid-cols-2 gap-4">
                            <button onclick="suggestMessage('love')" class="p-4 bg-white rounded-lg border hover:border-pink-300 hover:bg-pink-50 transition-colors text-left">
                                <div class="flex items-center space-x-2 mb-2">
                                    <i data-lucide="heart" class="w-5 h-5 text-pink-500"></i>
                                    <span class="font-medium">Mensagem de Amor</span>
                                </div>
                                <p class="text-sm text-gray-600">Expressar amor incondicional</p>
                            </button>
                            
                            <button onclick="suggestMessage('advice')" class="p-4 bg-white rounded-lg border hover:border-blue-300 hover:bg-blue-50 transition-colors text-left">
                                <div class="flex items-center space-x-2 mb-2">
                                    <i data-lucide="lightbulb" class="w-5 h-5 text-blue-500"></i>
                                    <span class="font-medium">Conselhos de Vida</span>
                                </div>
                                <p class="text-sm text-gray-600">Compartilhar sabedoria e experi√™ncias</p>
                            </button>
                            
                            <button onclick="suggestMessage('memories')" class="p-4 bg-white rounded-lg border hover:border-green-300 hover:bg-green-50 transition-colors text-left">
                                <div class="flex items-center space-x-2 mb-2">
                                    <i data-lucide="camera" class="w-5 h-5 text-green-500"></i>
                                    <span class="font-medium">Mem√≥rias Especiais</span>
                                </div>
                                <p class="text-sm text-gray-600">Relembrar momentos √∫nicos</p>
                            </button>
                            
                            <button onclick="suggestMessage('future')" class="p-4 bg-white rounded-lg border hover:border-purple-300 hover:bg-purple-50 transition-colors text-left">
                                <div class="flex items-center space-x-2 mb-2">
                                    <i data-lucide="star" class="w-5 h-5 text-purple-500"></i>
                                    <span class="font-medium">Desejos para o Futuro</span>
                                </div>
                                <p class="text-sm text-gray-600">Expressar esperan√ßas e sonhos</p>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex items-center justify-between mt-8">
                <button onclick="goBack()" class="flex items-center space-x-2 px-6 py-3 text-gray-600 hover:text-gray-800">
                    <i data-lucide="arrow-left" class="w-5 h-5"></i>
                    <span>Voltar</span>
                </button>
                
                <div class="flex items-center space-x-4">
                    <button onclick="saveProgress()" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors flex items-center space-x-2">
                        <i data-lucide="save" class="w-5 h-5"></i>
                        <span>Salvar Progresso</span>
                    </button>
                    
                    <button onclick="previewCofre()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2">
                        <i data-lucide="eye" class="w-5 h-5"></i>
                        <span>Visualizar Cofre</span>
                    </button>
                    
                    <button onclick="finalizeCofre()" class="gradient-bg text-white px-8 py-3 rounded-lg hover:opacity-90 transition-opacity flex items-center space-x-2">
                        <span>Finalizar Cofre</span>
                        <i data-lucide="arrow-right" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        lucide.createIcons();
        
        let currentTab = 'photos';
        let currentAlbum = 1;
        let photos = { 1: [], 2: [], 3: [], 4: [] };
        let videos = [];
        let messages = [];

        // Tab switching
        function switchTab(tab) {
            // Hide all content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('border-blue-500', 'text-blue-600');
                button.classList.add('border-transparent');
            });

            // Show selected content
            document.getElementById(tab + 'Content').classList.remove('hidden');
            document.getElementById(tab + 'Tab').classList.add('border-blue-500', 'text-blue-600');
            
            currentTab = tab;
        }

        // Album switching
        function switchAlbum(albumNum) {
            document.querySelectorAll('.album-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById('album' + albumNum + 'Tab').classList.add('active');
            currentAlbum = albumNum;
            updatePhotosGrid();
        }

        // Drag and drop handlers
        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(event) {
            event.currentTarget.classList.remove('dragover');
        }

        function handlePhotoDrop(event) {
            event.preventDefault();
            event.currentTarget.classList.remove('dragover');
            const files = Array.from(event.dataTransfer.files).filter(file => file.type.startsWith('image/'));
            handlePhotoFiles(files);
        }

        function handleVideoDrop(event) {
            event.preventDefault();
            event.currentTarget.classList.remove('dragover');
            const files = Array.from(event.dataTransfer.files).filter(file => file.type.startsWith('video/'));
            handleVideoFiles(files);
        }

        function handlePhotoSelect(event) {
            const files = Array.from(event.target.files);
            handlePhotoFiles(files);
        }

        function handleVideoSelect(event) {
            const files = Array.from(event.target.files);
            handleVideoFiles(files);
        }

        function handlePhotoFiles(files) {
            if (photos[currentAlbum].length + files.length > 10) {
                alert('M√°ximo 10 fotos por √°lbum!');
                return;
            }

            files.forEach(file => {
                if (file.size > 5 * 1024 * 1024) {
                    alert('Arquivo muito grande: ' + file.name + '. M√°ximo 5MB por foto.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(e) {
                    photos[currentAlbum].push({
                        name: file.name,
                        url: e.target.result,
                        size: file.size
                    });
                    updatePhotosGrid();
                    updateCounts();
                };
                reader.readAsDataURL(file);
            });
        }

        function handleVideoFiles(files) {
            if (videos.length + files.length > 2) {
                alert('M√°ximo 2 v√≠deos!');
                return;
            }

            files.forEach(file => {
                if (file.size > 100 * 1024 * 1024) {
                    alert('Arquivo muito grande: ' + file.name + '. M√°ximo 100MB por v√≠deo.');
                    return;
                }

                videos.push({
                    name: file.name,
                    file: file,
                    size: file.size,
                    title: '',
                    description: ''
                });
                updateVideosList();
                updateCounts();
            });
        }

        function updatePhotosGrid() {
            const grid = document.getElementById('photosGrid');
            grid.innerHTML = '';

            photos[currentAlbum].forEach((photo, index) => {
                const photoDiv = document.createElement('div');
                photoDiv.className = 'photo-preview bg-gray-100 rounded-lg overflow-hidden aspect-square';
                photoDiv.innerHTML = `
                    <img src="${photo.url}" alt="${photo.name}" class="w-full h-full object-cover">
                    <div class="absolute top-2 right-2">
                        <button onclick="removePhoto(${index})" class="bg-red-500 text-white rounded-full p-1 hover:bg-red-600">
                            <i data-lucide="x" class="w-4 h-4"></i>
                        </button>
                    </div>
                `;
                grid.appendChild(photoDiv);
            });
            lucide.createIcons();
        }

        function updateVideosList() {
            const list = document.getElementById('videosList');
            list.innerHTML = '';

            videos.forEach((video, index) => {
                const videoDiv = document.createElement('div');
                videoDiv.className = 'bg-gray-50 rounded-lg p-4';
                videoDiv.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <div class="w-16 h-16 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i data-lucide="video" class="w-8 h-8 text-purple-600"></i>
                        </div>
                        <div class="flex-1">
                            <input type="text" placeholder="T√≠tulo do v√≠deo" value="${video.title}" onchange="updateVideoTitle(${index}, this.value)" class="w-full font-medium text-gray-900 bg-transparent border-b border-gray-300 focus:border-purple-500 outline-none mb-2">
                            <textarea placeholder="Descri√ß√£o (opcional)" onchange="updateVideoDescription(${index}, this.value)" class="w-full text-sm text-gray-600 bg-transparent border-b border-gray-300 focus:border-purple-500 outline-none resize-none" rows="2">${video.description}</textarea>
                            <p class="text-xs text-gray-400 mt-1">${video.name} ‚Ä¢ ${(video.size / 1024 / 1024).toFixed(1)}MB</p>
                        </div>
                        <button onclick="removeVideo(${index})" class="text-red-500 hover:text-red-700">
                            <i data-lucide="trash-2" class="w-5 h-5"></i>
                        </button>
                    </div>
                `;
                list.appendChild(videoDiv);
            });
            lucide.createIcons();
        }

        function addMessage() {
            if (messages.length >= 5) {
                alert('M√°ximo 5 mensagens!');
                return;
            }

            const messageId = Date.now();
            messages.push({
                id: messageId,
                title: '',
                content: '',
                deliveryDate: ''
            });
            updateMessagesList();
            updateCounts();
        }

        function updateMessagesList() {
            const list = document.getElementById('messagesList');
            list.innerHTML = '';

            messages.forEach((message, index) => {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'bg-gray-50 rounded-lg p-6';
                messageDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <input type="text" placeholder="T√≠tulo da mensagem" value="${message.title}" onchange="updateMessageTitle(${index}, this.value)" class="text-lg font-medium text-gray-900 bg-transparent border-b border-gray-300 focus:border-blue-500 outline-none flex-1 mr-4">
                        <button onclick="removeMessage(${index})" class="text-red-500 hover:text-red-700">
                            <i data-lucide="trash-2" class="w-5 h-5"></i>
                        </button>
                    </div>
                    <textarea placeholder="Escreva sua mensagem especial aqui..." onchange="updateMessageContent(${index}, this.value)" class="message-editor w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none" rows="8">${message.content}</textarea>
                    <div class="mt-4 flex items-center space-x-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Entrega programada (opcional)</label>
                            <input type="date" value="${message.deliveryDate}" onchange="updateMessageDelivery(${index}, this.value)" class="px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <button onclick="suggestMessageImprovement(${index})" class="bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200 transition-colors flex items-center space-x-2">
                            <i data-lucide="sparkles" class="w-4 h-4"></i>
                            <span>Melhorar com IA</span>
                        </button>
                    </div>
                `;
                list.appendChild(messageDiv);
            });
            lucide.createIcons();
        }

        function updateCounts() {
            const totalPhotos = Object.values(photos).reduce((sum, album) => sum + album.length, 0);
            document.getElementById('photosCount').textContent = `${totalPhotos}/40`;
            document.getElementById('videosCount').textContent = `${videos.length}/2`;
            document.getElementById('messagesCount').textContent = `${messages.length}/5`;

            // Update album counts
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`album${i}Tab`).innerHTML = `√Ålbum ${i} <span class="text-xs">(${photos[i].length}/10)</span>`;
            }
        }

        // Remove functions
        function removePhoto(index) {
            photos[currentAlbum].splice(index, 1);
            updatePhotosGrid();
            updateCounts();
        }

        function removeVideo(index) {
            videos.splice(index, 1);
            updateVideosList();
            updateCounts();
        }

        function removeMessage(index) {
            messages.splice(index, 1);
            updateMessagesList();
            updateCounts();
        }

        // Update functions
        function updateVideoTitle(index, title) {
            videos[index].title = title;
        }

        function updateVideoDescription(index, description) {
            videos[index].description = description;
        }

        function updateMessageTitle(index, title) {
            messages[index].title = title;
        }

        function updateMessageContent(index, content) {
            messages[index].content = content;
        }

        function updateMessageDelivery(index, date) {
            messages[index].deliveryDate = date;
        }

        // AI functions
        function generateScript() {
            const type = document.getElementById('videoType').value;
            const details = document.getElementById('videoDetails').value;

            if (!type) {
                alert('Por favor, selecione o tipo de v√≠deo.');
                return;
            }

            // Simulate AI generation
            const scripts = {
                birthday: `Ol√° minha querida! Hoje √© um dia muito especial - seu anivers√°rio! üéâ

Quero que voc√™ saiba o quanto voc√™ significa para mim. Cada ano que passa, vejo voc√™ crescer e se tornar uma pessoa ainda mais incr√≠vel.

Lembro-me de quando voc√™ era pequena e sempre sonhava em... [personalize com suas mem√≥rias]

Meus desejos para voc√™ neste novo ano de vida:
- Que voc√™ continue sendo essa pessoa maravilhosa
- Que realize todos os seus sonhos
- Que seja sempre feliz e saud√°vel

Parab√©ns, meu amor! Voc√™ merece toda a felicidade do mundo! ‚ù§Ô∏è`,

                advice: `Minha querida, quero compartilhar alguns conselhos que aprendi ao longo da vida:

1. Seja sempre verdadeira consigo mesma
2. Nunca tenha medo de sonhar grande
3. Trate as pessoas com gentileza e respeito
4. Aprenda com os erros, eles s√£o seus professores
5. Valorize as pequenas coisas da vida

Lembre-se: voc√™ √© mais forte do que imagina e capaz de superar qualquer desafio. Confie em si mesma e siga seu cora√ß√£o.

Estarei sempre torcendo por voc√™, onde quer que eu esteja. ‚ù§Ô∏è`,

                memories: `Quero compartilhar algumas das minhas mem√≥rias mais preciosas com voc√™...

Lembro-me de quando... [personalize com suas mem√≥rias espec√≠ficas]

Esses momentos s√£o tesouros que guardo no cora√ß√£o. Cada risada, cada conversa, cada abra√ßo - tudo isso faz parte de quem somos.

Obrigado(a) por me dar tantas mem√≥rias lindas para guardar. Voc√™ tornou minha vida muito mais especial e cheia de amor.

Continue criando mem√≥rias maravilhosas! ‚ù§Ô∏è`
            };

            const script = scripts[type] || 'Script personalizado ser√° gerado baseado nos detalhes fornecidos...';
            
            document.getElementById('scriptContent').textContent = script;
            document.getElementById('generatedScript').classList.remove('hidden');
        }

        function copyScript() {
            const script = document.getElementById('scriptContent').textContent;
            navigator.clipboard.writeText(script).then(() => {
                alert('Script copiado para a √°rea de transfer√™ncia!');
            });
        }

        function regenerateScript() {
            generateScript();
        }

        function suggestMessage(type) {
            const suggestions = {
                love: 'Minha querida, quero que voc√™ saiba que meu amor por voc√™ √© infinito e incondicional. Voc√™ √© a luz da minha vida e minha maior alegria...',
                advice: 'Ao longo da vida, aprendi algumas li√ß√µes valiosas que gostaria de compartilhar com voc√™. Primeiro, sempre seja verdadeira consigo mesma...',
                memories: 'Tenho tantas mem√≥rias lindas guardadas no cora√ß√£o. Lembro-me de quando voc√™ era pequena e sempre me perguntava sobre...',
                future: 'Meus desejos para o seu futuro s√£o os mais belos poss√≠veis. Que voc√™ encontre sua paix√£o, realize seus sonhos e seja imensamente feliz...'
            };

            if (messages.length >= 5) {
                alert('M√°ximo 5 mensagens!');
                return;
            }

            const messageId = Date.now();
            messages.push({
                id: messageId,
                title: 'Mensagem Especial',
                content: suggestions[type],
                deliveryDate: ''
            });
            updateMessagesList();
            updateCounts();
        }

        function suggestMessageImprovement(index) {
            alert('Funcionalidade de melhoria com IA ser√° implementada em breve!');
        }

        // Action functions
        function saveProgress() {
            const data = {
                photos: photos,
                videos: videos,
                messages: messages
            };
            localStorage.setItem('cofreContent', JSON.stringify(data));
            alert('Progresso salvo com sucesso!');
        }

        function previewCofre() {
            saveProgress();
            window.open('cofre-digital-destinatario.html', '_blank');
        }

        function finalizeCofre() {
            if (Object.values(photos).every(album => album.length === 0) && videos.length === 0 && messages.length === 0) {
                alert('Adicione pelo menos um conte√∫do (foto, v√≠deo ou mensagem) antes de finalizar.');
                return;
            }

            if (confirm('Tem certeza que deseja finalizar o cofre? Ap√≥s finalizar, ele ser√° enviado para o destinat√°rio.')) {
                saveProgress();
                alert('Cofre finalizado com sucesso! O destinat√°rio receber√° um e-mail com as instru√ß√µes de acesso.');
                // Redirect to success page or dashboard
            }
        }

        function goBack() {
            if (confirm('Tem certeza que deseja voltar? O progresso n√£o salvo ser√° perdido.')) {
                window.history.back();
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            switchTab('photos');
            switchAlbum(1);
            
            // Load saved config
            const config = localStorage.getItem('cofreConfig');
            if (config) {
                const data = JSON.parse(config);
                // Update recipient name display
                const recipients = ['Maria Silva', 'Jo√£o Silva', 'Ana Santos'];
                if (data.recipient && recipients[data.recipient - 1]) {
                    document.getElementById('recipientName').textContent = recipients[data.recipient - 1];
                    document.getElementById('recipientNameContent').textContent = recipients[data.recipient - 1].split(' ')[0];
                }
            }
        });
    </script>
</body>
</html>

